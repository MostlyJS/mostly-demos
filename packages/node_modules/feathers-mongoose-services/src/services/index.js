import path from 'path';
import mongoose from 'mongoose';
import { config } from 'common';

export default function() {
  const app = this;

  mongoose.connect(config.mongodb.db)
  .catch(err => {
    console.log('connect to %s error: ', config.mongodb.db, err.message);
    process.exit(1);
  });

  mongoose.Promise = global.Promise;
  mongoose.set('debug', true);

  // Load All Services
  var servies = [
    'dummy'
  ];
  servies.forEach(function(filePath) {
    var service = require(path.join(__dirname, filePath));
    app.configure(service);
  });
}