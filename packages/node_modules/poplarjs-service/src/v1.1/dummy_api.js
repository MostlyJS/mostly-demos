const makeDebug = require('debug');
const poplar = require('mostly-poplarjs');

const DummyApiV1 = require('../v1/dummy_api');

const debug = makeDebug('poplarjs:dummy_api');

const DummyApi = new poplar.ApiBuilder('dummies', { version: 'v1.1' });
DummyApi.extend(DummyApiV1);

DummyApi.before('*', function (ctx, next) {
  console.log('  => before.dummies.v1.1.* called');
  next();
});

DummyApi.after('*', function (ctx, next) {
  console.log('  => after.dummies.v1.1.* called');
  next();
});

DummyApi.define('show', {
  accepts: [
    {
      arg: 'id',
      type: 'number',
      required: true,
      description: 'user id'
    }
  ],
  description: 'Get user info',
  http: { path: ':id/show', verb: 'get'  }
}, function (params, cb) {
  cb(null, { id: params.id, version: 'v1.1' });
});

module.exports = DummyApi;
